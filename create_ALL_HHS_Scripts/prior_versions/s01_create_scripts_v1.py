

# ## ************************************************ PART I - create XML files ************************************************

# # ---------------- start ONE-TIME-RUN-SCRIPT ALL_HHS_PROCESSING ----------------

# import os
# base_dir = r'C:\Users\johnp\OneDrive - Delphi Consulting Solutions\Delphics\Project Independence\300 Develop\Python Scripts'

# base_output_dir = os.path.join(base_dir, 'fpds_output_files')
# xml_output_dir = os.path.join(base_output_dir,'xml_output')
# json_output_dir = os.path.join(base_output_dir,'json_output')

# os.mkdir(base_output_dir)
# os.mkdir(xml_output_dir)
# os.mkdir(json_output_dir)

# # ---------------- end ONE-TIME-RUN-SCRIPT ALL_HHS_PROCESSING ----------------


# # ---------------- start script for ALL_HHS_PROCESSING ----------------
# from clsFPDS import FPDS
# agency_code=7525
# entry_action_type='Created'
# date_extract_from='2018-10-01'
# date_extract_thru='2018-10-05'


# fpds = FPDS(agency_code=agency_code, entry_action_type=entry_action_type, date_extract_from=date_extract_from, date_extract_thru=date_extract_thru)
# fpds.process_all_pages(xml_output_dir)
# # ---------------- end script for ALL_HHS_PROCESSING ----------------


# ************************************************ PART II - convert to JSON files ************************************************
# import xml.etree.ElementTree as ET
# from fpds import fpdsXML
# import json
# import os


# for xml_file in os.listdir(xml_output_dir):       ## get list of xml files so we can convert them to json
#     full_xml_file_path = os.path.join(xml_output_dir, xml_file)
#     print(full_xml_file_path)


#     tree = ET.parse(full_xml_file_path)
#     myXML = fpdsXML(content=tree)

#     entries = myXML.jsonified_entries()

#     json_full_file_path = os.path.join(json_output_dir, xml_file.replace('.xml','.json'))
#     with open(json_full_file_path, 'w') as new_json_file:
#         json.dump(entries, new_json_file)


import os


def get_script_template():
    return f'''

{import_statement}

agency_code={agency_code}
entry_action_type='Created'
date_extract_from='{date_extract_from}'
date_extract_thru='{date_extract_thru}'

fpds = FPDS(agency_code=agency_code, entry_action_type=entry_action_type, date_extract_from=date_extract_from, date_extract_thru=date_extract_thru)
fpds.process_all_api_urls(r'{base_dir}')
    
'''


vals = [(1, '7500', '2018-10-01', '2019-09-30'), (2, '7500', '2019-10-01', '2020-09-30'), (3, '7500', '2020-10-01', '2021-09-30'), (4, '7500', '2021-10-01', '2022-09-30'), (5, '7500', '2022-10-01', '2023-09-30'), (6, '7501', '2018-10-01', '2019-09-30'), (7, '7501', '2019-10-01', '2020-09-30'),   (8, '7501', '2020-10-01', '2021-09-30'), (9, '7501', '2021-10-01', '2022-09-30'), (10, '7501', '2022-10-01', '2023-09-30'), (1, '7502', '2018-10-01', '2019-09-30'), (2, '7502', '2019-10-01', '2020-09-30'), (3, '7502', '2020-10-01', '2021-09-30'), (4, '7502', '2021-10-01', '2022-09-30'),   (5, '7502', '2022-10-01', '2023-09-30'), (6, '7503', '2018-10-01', '2019-09-30'), (7, '7503', '2019-10-01', '2020-09-30'), (8, '7503', '2020-10-01', '2021-09-30'), (9, '7503', '2021-10-01', '2022-09-30'), (10, '7503', '2022-10-01', '2023-09-30'), (1, '7504', '2018-10-01', '2019-09-30'),   (2, '7504', '2019-10-01', '2020-09-30'), (3, '7504', '2020-10-01', '2021-09-30'), (4, '7504', '2021-10-01', '2022-09-30'), (5, '7504', '2022-10-01', '2023-09-30'), (6, '7505', '2018-10-01', '2019-09-30'), (7, '7505', '2019-10-01', '2020-09-30'), (8, '7505', '2020-10-01', '2021-09-30'),   (9, '7505', '2021-10-01', '2022-09-30'), (10, '7505', '2022-10-01', '2023-09-30'), (1, '7506', '2018-10-01', '2019-09-30'), (2, '7506', '2019-10-01', '2020-09-30'), (3, '7506', '2020-10-01', '2021-09-30'), (4, '7506', '2021-10-01', '2022-09-30'), (5, '7506', '2022-10-01', '2023-09-30'),   (6, '7507', '2018-10-01', '2019-09-30'), (7, '7507', '2019-10-01', '2020-09-30'), (8, '7507', '2020-10-01', '2021-09-30'), (9, '7507', '2021-10-01', '2022-09-30'), (10, '7507', '2022-10-01', '2023-09-30'), (1, '7508', '2018-10-01', '2019-09-30'), (2, '7508', '2019-10-01', '2020-09-30'),   (3, '7508', '2020-10-01', '2021-09-30'), (4, '7508', '2021-10-01', '2022-09-30'), (5, '7508', '2022-10-01', '2023-09-30'), (6, '7509', '2018-10-01', '2019-09-30'), (7, '7509', '2019-10-01', '2020-09-30'), (8, '7509', '2020-10-01', '2021-09-30'), (9, '7509', '2021-10-01', '2022-09-30'),   (10, '7509', '2022-10-01', '2023-09-30'), (1, '750S', '2018-10-01', '2019-09-30'), (2, '750S', '2019-10-01', '2020-09-30'), (3, '750S', '2020-10-01', '2021-09-30'), (4, '750S', '2021-10-01', '2022-09-30'), (5, '750S', '2022-10-01', '2023-09-30'), (6, '7510', '2018-10-01', '2019-09-30'),   (7, '7510', '2019-10-01', '2020-09-30'), (8, '7510', '2020-10-01', '2021-09-30'), (9, '7510', '2021-10-01', '2022-09-30'), (10, '7510', '2022-10-01', '2023-09-30'), (1, '7511', '2018-10-01', '2019-09-30'), (2, '7511', '2019-10-01', '2020-09-30'), (3, '7511', '2020-10-01', '2021-09-30'),   (4, '7511', '2021-10-01', '2022-09-30'), (5, '7511', '2022-10-01', '2023-09-30'), (6, '7512', '2018-10-01', '2019-09-30'), (7, '7512', '2019-10-01', '2020-09-30'), (8, '7512', '2020-10-01', '2021-09-30'), (9, '7512', '2021-10-01', '2022-09-30'), (10, '7512', '2022-10-01', '2023-09-30'),   (1, '7515', '2018-10-01', '2019-09-30'), (2, '7515', '2019-10-01', '2020-09-30'), (3, '7515', '2020-10-01', '2021-09-30'), (4, '7515', '2021-10-01', '2022-09-30'), (5, '7515', '2022-10-01', '2023-09-30'), (6, '7516', '2018-10-01', '2019-09-30'), (7, '7516', '2019-10-01', '2020-09-30'),   (8, '7516', '2020-10-01', '2021-09-30'), (9, '7516', '2021-10-01', '2022-09-30'), (10, '7516', '2022-10-01', '2023-09-30'), (1, '7520', '2018-10-01', '2019-09-30'), (2, '7520', '2019-10-01', '2020-09-30'), (3, '7520', '2020-10-01', '2021-09-30'), (4, '7520', '2021-10-01', '2022-09-30'),   (5, '7520', '2022-10-01', '2023-09-30'), (6, '7521', '2018-10-01', '2019-09-30'), (7, '7521', '2019-10-01', '2020-09-30'), (8, '7521', '2020-10-01', '2021-09-30'), (9, '7521', '2021-10-01', '2022-09-30'), (10, '7521', '2022-10-01', '2023-09-30'), (1, '7522', '2018-10-01', '2019-09-30'),   (2, '7522', '2019-10-01', '2020-09-30'), (3, '7522', '2020-10-01', '2021-09-30'), (4, '7522', '2021-10-01', '2022-09-30'), (5, '7522', '2022-10-01', '2023-09-30'), (6, '7523', '2018-10-01', '2019-09-30'), (7, '7523', '2019-10-01', '2020-09-30'), (8, '7523', '2020-10-01', '2021-09-30'),   (9, '7523', '2021-10-01', '2022-09-30'), (10, '7523', '2022-10-01', '2023-09-30'), (1, '7524', '2018-10-01', '2019-09-30'), (2, '7524', '2019-10-01', '2020-09-30'), (3, '7524', '2020-10-01', '2021-09-30'), (4, '7524', '2021-10-01', '2022-09-30'), (5, '7524', '2022-10-01', '2023-09-30'),   (6, '7525', '2018-10-01', '2019-09-30'), (7, '7525', '2019-10-01', '2020-09-30'), (8, '7525', '2020-10-01', '2021-09-30'), (9, '7525', '2021-10-01', '2022-09-30'), (10, '7525', '2022-10-01', '2023-09-30'), (1, '7526', '2018-10-01', '2019-09-30'), (2, '7526', '2019-10-01', '2020-09-30'),   (3, '7526',
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    '2020-10-01', '2021-09-30'), (4, '7526', '2021-10-01', '2022-09-30'), (5, '7526', '2022-10-01', '2023-09-30'), (6, '7527', '2018-10-01', '2019-09-30'), (7, '7527', '2019-10-01', '2020-09-30'), (8, '7527', '2020-10-01', '2021-09-30'), (9, '7527', '2021-10-01', '2022-09-30'),   (10, '7527', '2022-10-01', '2023-09-30'), (1, '7528', '2018-10-01', '2019-09-30'), (2, '7528', '2019-10-01', '2020-09-30'), (3, '7528', '2020-10-01', '2021-09-30'), (4, '7528', '2021-10-01', '2022-09-30'), (5, '7528', '2022-10-01', '2023-09-30'), (6, '7529', '2018-10-01', '2019-09-30'),   (7, '7529', '2019-10-01', '2020-09-30'), (8, '7529', '2020-10-01', '2021-09-30'), (9, '7529', '2021-10-01', '2022-09-30'), (10, '7529', '2022-10-01', '2023-09-30'), (1, '7530', '2018-10-01', '2019-09-30'), (2, '7530', '2019-10-01', '2020-09-30'), (3, '7530', '2020-10-01', '2021-09-30'),   (4, '7530', '2021-10-01', '2022-09-30'), (5, '7530', '2022-10-01', '2023-09-30'), (6, '7537', '2018-10-01', '2019-09-30'), (7, '7537', '2019-10-01', '2020-09-30'), (8, '7537', '2020-10-01', '2021-09-30'), (9, '7537', '2021-10-01', '2022-09-30'), (10, '7537', '2022-10-01', '2023-09-30'),   (1, '7540', '2018-10-01', '2019-09-30'), (2, '7540', '2019-10-01', '2020-09-30'), (3, '7540', '2020-10-01', '2021-09-30'), (4, '7540', '2021-10-01', '2022-09-30'), (5, '7540', '2022-10-01', '2023-09-30'), (6, '7545', '2018-10-01', '2019-09-30'), (7, '7545', '2019-10-01', '2020-09-30'),   (8, '7545', '2020-10-01', '2021-09-30'), (9, '7545', '2021-10-01', '2022-09-30'), (10, '7545', '2022-10-01', '2023-09-30'), (1, '7550', '2018-10-01', '2019-09-30'), (2, '7550', '2019-10-01', '2020-09-30'), (3, '7550', '2020-10-01', '2021-09-30'), (4, '7550', '2021-10-01', '2022-09-30'),   (5, '7550', '2022-10-01', '2023-09-30'), (6, '7555', '2018-10-01', '2019-09-30'), (7, '7555', '2019-10-01', '2020-09-30'), (8, '7555', '2020-10-01', '2021-09-30'), (9, '7555', '2021-10-01', '2022-09-30'), (10, '7555', '2022-10-01', '2023-09-30'), (1, '7558', '2018-10-01', '2019-09-30'),   (2, '7558', '2019-10-01', '2020-09-30'), (3, '7558', '2020-10-01', '2021-09-30'), (4, '7558', '2021-10-01', '2022-09-30'), (5, '7558', '2022-10-01', '2023-09-30'), (6, '7559', '2018-10-01', '2019-09-30'), (7, '7559', '2019-10-01', '2020-09-30'), (8, '7559', '2020-10-01', '2021-09-30'),   (9, '7559', '2021-10-01', '2022-09-30'), (10, '7559', '2022-10-01', '2023-09-30'), (1, '7565', '2018-10-01', '2019-09-30'), (2, '7565', '2019-10-01', '2020-09-30'), (3, '7565', '2020-10-01', '2021-09-30'), (4, '7565', '2021-10-01', '2022-09-30'), (5, '7565', '2022-10-01', '2023-09-30'), (6, '7570', '2018-10-01', '2019-09-30'), (7, '7570', '2019-10-01', '2020-09-30'), (8, '7570', '2020-10-01', '2021-09-30'), (9, '7570', '2021-10-01', '2022-09-30'), (10, '7570', '2022-10-01', '2023-09-30'), (1, '7571', '2018-10-01', '2019-09-30'), (2, '7571', '2019-10-01', '2020-09-30'), (3, '7571', '2020-10-01', '2021-09-30'), (4, '7571', '2021-10-01', '2022-09-30'), (5, '7571', '2022-10-01', '2023-09-30'), (6, '7572', '2018-10-01', '2019-09-30'), (7, '7572', '2019-10-01', '2020-09-30'), (8, '7572', '2020-10-01', '2021-09-30'), (9, '7572', '2021-10-01', '2022-09-30'),   (10, '7572', '2022-10-01', '2023-09-30'), (1, '7573', '2018-10-01', '2019-09-30'), (2, '7573', '2019-10-01', '2020-09-30'), (3, '7573', '2020-10-01', '2021-09-30'), (4, '7573', '2021-10-01', '2022-09-30'), (5, '7573', '2022-10-01', '2023-09-30'), (6, '7574', '2018-10-01', '2019-09-30'),   (7, '7574', '2019-10-01', '2020-09-30'), (8, '7574', '2020-10-01', '2021-09-30'), (9, '7574', '2021-10-01', '2022-09-30'), (10, '7574', '2022-10-01', '2023-09-30'), (1, '7575', '2018-10-01', '2019-09-30'), (2, '7575', '2019-10-01', '2020-09-30'), (3, '7575', '2020-10-01', '2021-09-30'),   (4, '7575', '2021-10-01', '2022-09-30'), (5, '7575', '2022-10-01', '2023-09-30'), (6, '7576', '2018-10-01', '2019-09-30'), (7, '7576', '2019-10-01', '2020-09-30'), (8, '7576', '2020-10-01', '2021-09-30'), (9, '7576', '2021-10-01', '2022-09-30'), (10, '7576', '2022-10-01', '2023-09-30'),   (1, '7577', '2018-10-01', '2019-09-30'), (2, '7577', '2019-10-01', '2020-09-30'), (3, '7577', '2020-10-01', '2021-09-30'), (4, '7577', '2021-10-01', '2022-09-30'), (5, '7577', '2022-10-01', '2023-09-30'), (6, '7590', '2018-10-01', '2019-09-30'), (7, '7590', '2019-10-01', '2020-09-30'),   (8, '7590', '2020-10-01', '2021-09-30'), (9, '7590', '2021-10-01', '2022-09-30'), (10, '7590', '2022-10-01', '2023-09-30'), (1, '7593', '2018-10-01', '2019-09-30'), (2, '7593', '2019-10-01', '2020-09-30'), (3, '7593', '2020-10-01', '2021-09-30'), (4, '7593', '2021-10-01', '2022-09-30'),   (5, '7593', '2022-10-01', '2023-09-30')]


base_dir = r'C:\Users\Administrator\Documents\python_scripts'

base_output_dir = os.path.join(base_dir, 'fpds_output_files')
xml_output_dir = os.path.join(base_output_dir, 'xml_output')
json_output_dir = os.path.join(base_output_dir, 'json_output')

os.mkdir(base_output_dir)
os.mkdir(xml_output_dir)
os.mkdir(json_output_dir)

dest_path = r'C:\Users\Administrator\Documents\python_scripts'

folders_created = []
folder_cntr = 1  # we are using 1 as our first folder (see vals list above)


for v in vals:

    if v[0] not in folders_created:
        folders_created.append(v[0])
        import_statement = 'from clsFPDS import FPDS'
    else:
        import_statement = ''

    agency_code = v[1]
    date_extract_from = v[2]
    date_extract_thru = v[3]
    script_filename = os.path.join(dest_path, "script_" + str(v[0]) + ".py")

    script_template = get_script_template()

    with open(script_filename, 'a') as f:
        f.write(script_template)
